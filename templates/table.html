<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Tabelle {{ table }}</title>
  <script>
    async function updateCell(id, column, value) {
      const payload = { id };
      payload[column] = value;
      const res = await fetch(`/api/data/{{ table }}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });
      const result = await res.json();
      console.log(result);
    }

    async function deleteRow(id) {
      const res = await fetch(`/api/data/{{ table }}`, {
        method: "DELETE",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id }),
      });
      const result = await res.json();
      console.log(result);
      location.reload();
    }
  </script>
</head>
<body>
  <h1>Tabelle: {{ table }}</h1>
  <table border="1">
    <thead>
      <tr>
        {% for col in columns %}
          <th>{{ col }}</th>
        {% endfor %}
        <th>Aktion</th>
      </tr>
    </thead>
    <tbody>
      {% for row in rows %}
        <tr>
          {% for col in columns %}
            <td contenteditable="{{ 'false' if col == 'id' else 'true' }}"
                onblur="updateCell({{ row['id'] }}, '{{ col }}', this.innerText)">
              {{ row[col] }}
            </td>
          {% endfor %}
          <td><button onclick="deleteRow({{ row['id'] }})">üóëÔ∏è</button></td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <br>
  <a href="/">Zur√ºck zur √úbersicht</a>
</body>
</html>

