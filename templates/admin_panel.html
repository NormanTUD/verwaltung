{% extends "layout.html" %}
{% block title %}Aggregat{% endblock %}
{% block content %}
		<h1>Admin Panel</h1>

		<h2>Benutzerliste</h2>
		<table>
			<tr>
				<th>ID</th>
				<th>Username</th>
				<th>Rollen</th>
				<th>Passwort</th>
				<th>Ändern</th>
				<th>Löschen</th>
			</tr>
			{% for user in users %}
			<tr>
				<form action="{{ url_for('update_user', user_id=user.id) }}" method="post">
					<td>{{ user.id }}</td>
					<td>
						<input name="username" value="{{ user.username }}">
					</td>
					<td>
						<select name="role_id">
							<option value="">Keine</option>
							{% for role in roles %}
							<option value="{{ role.id }}" {% if role in user.roles %}selected{% endif %}>{{ role.name }}</option>
							{% endfor %}
						</select>
					</td>
					<td>
						<input type="password" name="new_password" placeholder="Neues Passwort">
					</td>
					<td class="actions">
						<button type="submit">Ändern</button>
					</td>
					<td class="actions">
						<a href="{{ url_for('delete_user', user_id=user.id) }}" onclick="return confirm('Wirklich löschen?')">Löschen</a>
					</td>
				</form>
			</tr>
			{% endfor %}
		</table>

		<h2>Neuen Benutzer hinzufügen</h2>
		<div class="add-user-form">
			<form method="post">
				<input type="text" name="new_username" placeholder="Benutzername" required>
				<input type="password" name="new_password" placeholder="Passwort" required>
				<select name="new_role">
					<option value="">Keine Rolle</option>
					{% for role in roles %}
					<option value="{{ role.id }}">{{ role.name }}</option>
					{% endfor %}
				</select>
				<button type="submit">Hinzufügen</button>
			</form>
		</div>
{% endblock %}
